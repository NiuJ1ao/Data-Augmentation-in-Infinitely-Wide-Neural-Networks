WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
[2022-08-16 23:16:09,297 INFO] (util:27) Namespace(augment_X='/vol/bitbucket/yn621/data/mnist60k-augs-patterns.npy', augment_y='/vol/bitbucket/yn621/data/mnist60k-augs-labels.npy', batch_size=0, device_count=-1, epochs=1, lr=0.1, model='fcn', momentum=0.9, num_inducing_points=750, select_method='random')
[2022-08-16 23:16:10,637 INFO] (data_loader:126) MNIST: (60000, 784) train, (10000, 784) test samples.
[2022-08-16 23:16:10,960 INFO] (data_loader:193) MNIST: (60000, 784) augmented train
[2022-08-16 23:16:11,402 INFO] (snngp_inference:47) Training data after augmentation: (120000, 784), (120000, 10)
[2022-08-16 23:16:11,448 INFO] (snngp_vary_inducing_random:30) 
----Number of inducing point: 1000----
[2022-08-16 23:16:11,750 INFO] (snngp_inference:59) inducing_points shape: (1000, 784)
[2022-08-16 23:16:11,787 INFO] (snngp:271) Optimizing...
2022-08-16 23:16:56.928304: E external/org_tensorflow/tensorflow/compiler/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  dot.2 (displaying the full instruction incurs a runtime overhead. Raise your logging level to 4 or above).

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime.  XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2022-08-16 23:16:57.367756: E external/org_tensorflow/tensorflow/compiler/xla/service/slow_operation_alarm.cc:133] The operation took 1.439584147s
Constant folding an instruction is taking > 1s:

  dot.2 (displaying the full instruction incurs a runtime overhead. Raise your logging level to 4 or above).

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime.  XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2022-08-16 23:16:59.368018: E external/org_tensorflow/tensorflow/compiler/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 2s:

  dot.3 (displaying the full instruction incurs a runtime overhead. Raise your logging level to 4 or above).

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime.  XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2022-08-16 23:17:04.538626: E external/org_tensorflow/tensorflow/compiler/xla/service/slow_operation_alarm.cc:133] The operation took 7.170680285s
Constant folding an instruction is taking > 2s:

  dot.3 (displaying the full instruction incurs a runtime overhead. Raise your logging level to 4 or above).

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime.  XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
[2022-08-16 23:28:18,500 INFO] (snngp:279) Optimized for 21 iters; Success: True; Result: [0.99471507 0.10369071], 0.021422609720780486
[2022-08-16 23:28:38,438 INFO] (snngp_vary_inducing_random:47) ELBO: 53785.4206682015
[2022-08-16 23:28:42,461 INFO] (snngp_vary_inducing_random:49) EUBO: 119405.04369209117
[2022-08-16 23:28:47,999 INFO] (snngp_vary_inducing_random:53) Loss: 0.12580589283005042
[2022-08-16 23:28:48,138 INFO] (snngp_vary_inducing_random:55) Accuracy: 95.85%
[2022-08-16 23:28:48,138 INFO] (snngp_vary_inducing_random:30) 
----Number of inducing point: 3000----
[2022-08-16 23:28:48,364 INFO] (snngp_inference:59) inducing_points shape: (3000, 784)
[2022-08-16 23:28:48,365 INFO] (snngp:271) Optimizing...
2022-08-16 23:29:33.690806: E external/org_tensorflow/tensorflow/compiler/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 4s:

  dot.2 (displaying the full instruction incurs a runtime overhead. Raise your logging level to 4 or above).

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime.  XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2022-08-16 23:29:42.817820: E external/org_tensorflow/tensorflow/compiler/xla/service/slow_operation_alarm.cc:133] The operation took 13.132974248s
Constant folding an instruction is taking > 4s:

  dot.2 (displaying the full instruction incurs a runtime overhead. Raise your logging level to 4 or above).

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime.  XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
[2022-08-16 23:50:29,771 INFO] (snngp:279) Optimized for 11 iters; Success: True; Result: [1.05803318 0.13139434], 0.01614054160637569
[2022-08-16 23:51:13,272 INFO] (snngp_vary_inducing_random:47) ELBO: 68394.64985033718
[2022-08-16 23:51:27,901 INFO] (snngp_vary_inducing_random:49) EUBO: 135381.95320061513
[2022-08-16 23:51:35,568 INFO] (snngp_vary_inducing_random:53) Loss: 0.1085010140181085
[2022-08-16 23:51:35,570 INFO] (snngp_vary_inducing_random:55) Accuracy: 97.37%
[2022-08-16 23:51:35,658 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 5000----
[2022-08-16 23:51:35,945 INFO] (snngp_inference:59) inducing_points shape: (5000, 784)
[2022-08-16 23:52:55,691 INFO] (snngp_vary_inducing_random:72) ELBO: 74181.24381092293
[2022-08-16 23:53:42,013 INFO] (snngp_vary_inducing_random:74) EUBO: 141714.80665658094
[2022-08-16 23:53:51,303 INFO] (snngp_vary_inducing_random:78) Loss: 0.10220185394578553
[2022-08-16 23:53:51,304 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.66%
[2022-08-16 23:53:51,893 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 6000----
[2022-08-16 23:53:52,107 INFO] (snngp_inference:59) inducing_points shape: (6000, 784)
[2022-08-16 23:55:30,346 INFO] (snngp_vary_inducing_random:72) ELBO: 75840.29750551298
[2022-08-16 23:56:12,878 INFO] (snngp_vary_inducing_random:74) EUBO: 141520.57564747144
[2022-08-16 23:56:24,883 INFO] (snngp_vary_inducing_random:78) Loss: 0.10082871342367582
[2022-08-16 23:56:24,884 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.71%
[2022-08-16 23:56:25,590 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 7000----
[2022-08-16 23:56:25,833 INFO] (snngp_inference:59) inducing_points shape: (7000, 784)
[2022-08-16 23:58:34,482 INFO] (snngp_vary_inducing_random:72) ELBO: 77539.47536462714
[2022-08-16 23:59:29,463 INFO] (snngp_vary_inducing_random:74) EUBO: 141354.95198735216
[2022-08-16 23:59:44,087 INFO] (snngp_vary_inducing_random:78) Loss: 0.09933049638912898
[2022-08-16 23:59:44,089 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.73%
[2022-08-16 23:59:44,737 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 8000----
[2022-08-16 23:59:44,974 INFO] (snngp_inference:59) inducing_points shape: (8000, 784)
[2022-08-17 00:02:31,885 INFO] (snngp_vary_inducing_random:72) ELBO: 78712.79248804858
[2022-08-17 00:03:45,959 INFO] (snngp_vary_inducing_random:74) EUBO: 141204.95026219773
[2022-08-17 00:04:03,274 INFO] (snngp_vary_inducing_random:78) Loss: 0.09833798708534593
[2022-08-17 00:04:03,275 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.86%
[2022-08-17 00:04:04,292 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 9000----
[2022-08-17 00:04:04,548 INFO] (snngp_inference:59) inducing_points shape: (9000, 784)
[2022-08-17 00:07:27,587 INFO] (snngp_vary_inducing_random:72) ELBO: 79629.39441708801
[2022-08-17 00:09:47,371 INFO] (snngp_vary_inducing_random:74) EUBO: 141069.73345027462
[2022-08-17 00:10:10,424 INFO] (snngp_vary_inducing_random:78) Loss: 0.09750376506213422
[2022-08-17 00:10:10,426 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.90%
[2022-08-17 00:10:11,705 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 10000----
[2022-08-17 00:10:11,919 INFO] (snngp_inference:59) inducing_points shape: (10000, 784)
[2022-08-17 00:14:10,519 INFO] (snngp_vary_inducing_random:72) ELBO: 80436.79829977144
[2022-08-17 00:16:14,465 INFO] (snngp_vary_inducing_random:74) EUBO: 140944.7848893811
[2022-08-17 00:16:38,071 INFO] (snngp_vary_inducing_random:78) Loss: 0.09683585950446534
[2022-08-17 00:16:38,073 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.91%
[2022-08-17 00:16:39,533 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 11000----
[2022-08-17 00:16:39,796 INFO] (snngp_inference:59) inducing_points shape: (11000, 784)
[2022-08-17 00:21:37,239 INFO] (snngp_vary_inducing_random:72) ELBO: 81168.2807422118
[2022-08-17 00:24:28,991 INFO] (snngp_vary_inducing_random:74) EUBO: 140825.4191004028
[2022-08-17 00:24:57,994 INFO] (snngp_vary_inducing_random:78) Loss: 0.09613967173053437
[2022-08-17 00:24:57,996 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.88%
[2022-08-17 00:24:59,739 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 12000----
[2022-08-17 00:24:59,989 INFO] (snngp_inference:59) inducing_points shape: (12000, 784)
[2022-08-17 00:30:28,340 INFO] (snngp_vary_inducing_random:72) ELBO: 81761.62352352656
[2022-08-17 00:33:23,299 INFO] (snngp_vary_inducing_random:74) EUBO: 140722.69187577482
[2022-08-17 00:33:54,210 INFO] (snngp_vary_inducing_random:78) Loss: 0.09558273600607682
[2022-08-17 00:33:54,212 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.93%
[2022-08-17 00:33:55,953 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 13000----
[2022-08-17 00:33:56,213 INFO] (snngp_inference:59) inducing_points shape: (13000, 784)
[2022-08-17 00:40:11,791 INFO] (snngp_vary_inducing_random:72) ELBO: 82311.30780829456
[2022-08-17 00:43:47,048 INFO] (snngp_vary_inducing_random:74) EUBO: 140614.55334682032
[2022-08-17 00:44:19,179 INFO] (snngp_vary_inducing_random:78) Loss: 0.0951354654997921
[2022-08-17 00:44:19,181 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.89%
[2022-08-17 00:44:20,504 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 14000----
[2022-08-17 00:44:20,753 INFO] (snngp_inference:59) inducing_points shape: (14000, 784)
[2022-08-17 00:51:58,910 INFO] (snngp_vary_inducing_random:72) ELBO: 82771.19904946076
[2022-08-17 00:55:50,802 INFO] (snngp_vary_inducing_random:74) EUBO: 140524.32784918213
[2022-08-17 00:56:26,107 INFO] (snngp_vary_inducing_random:78) Loss: 0.09479553832879635
[2022-08-17 00:56:26,108 INFO] (snngp_vary_inducing_random:80) Accuracy: 98.03%
[2022-08-17 00:56:27,771 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 15000----
[2022-08-17 00:56:28,029 INFO] (snngp_inference:59) inducing_points shape: (15000, 784)
[2022-08-17 01:05:22,468 INFO] (snngp_vary_inducing_random:72) ELBO: 83246.73459006194
[2022-08-17 01:09:48,668 INFO] (snngp_vary_inducing_random:74) EUBO: 140429.98732860904
[2022-08-17 01:10:29,679 INFO] (snngp_vary_inducing_random:78) Loss: 0.09455782258207714
[2022-08-17 01:10:29,681 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.95%
[2022-08-17 01:10:32,435 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 16000----
[2022-08-17 01:10:32,673 INFO] (snngp_inference:59) inducing_points shape: (16000, 784)
[2022-08-17 01:19:54,237 INFO] (snngp_vary_inducing_random:72) ELBO: 83702.47042385854
[2022-08-17 01:25:16,623 INFO] (snngp_vary_inducing_random:74) EUBO: 140349.18596504728
[2022-08-17 01:26:03,252 INFO] (snngp_vary_inducing_random:78) Loss: 0.09400714799547305
[2022-08-17 01:26:03,253 INFO] (snngp_vary_inducing_random:80) Accuracy: 97.97%
[2022-08-17 01:26:05,638 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 17000----
[2022-08-17 01:26:05,889 INFO] (snngp_inference:59) inducing_points shape: (17000, 784)
[2022-08-17 01:36:37,270 INFO] (snngp_vary_inducing_random:72) ELBO: 84073.12256608494
[2022-08-17 01:43:13,187 INFO] (snngp_vary_inducing_random:74) EUBO: 140266.30208747782
[2022-08-17 01:44:06,154 INFO] (snngp_vary_inducing_random:78) Loss: 0.09368388094399611
[2022-08-17 01:44:06,155 INFO] (snngp_vary_inducing_random:80) Accuracy: 98.07%
[2022-08-17 01:44:08,554 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 18000----
[2022-08-17 01:44:08,811 INFO] (snngp_inference:59) inducing_points shape: (18000, 784)
[2022-08-17 01:55:56,539 INFO] (snngp_vary_inducing_random:72) ELBO: 84373.09474622816
[2022-08-17 02:03:34,917 INFO] (snngp_vary_inducing_random:74) EUBO: 140188.9147732463
[2022-08-17 02:04:26,204 INFO] (snngp_vary_inducing_random:78) Loss: 0.09344277689990067
[2022-08-17 02:04:26,206 INFO] (snngp_vary_inducing_random:80) Accuracy: 98.06%
[2022-08-17 02:04:29,005 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 19000----
[2022-08-17 02:04:29,266 INFO] (snngp_inference:59) inducing_points shape: (19000, 784)
[2022-08-17 02:18:35,329 INFO] (snngp_vary_inducing_random:72) ELBO: 84692.22142762013
[2022-08-17 02:29:30,292 INFO] (snngp_vary_inducing_random:74) EUBO: 140113.27074093447
[2022-08-17 02:30:44,306 INFO] (snngp_vary_inducing_random:78) Loss: 0.09325724872919483
[2022-08-17 02:30:44,308 INFO] (snngp_vary_inducing_random:80) Accuracy: 98.06%
[2022-08-17 02:30:48,028 INFO] (snngp_vary_inducing_random:67) 
----Number of inducing point: 20000----
[2022-08-17 02:30:48,369 INFO] (snngp_inference:59) inducing_points shape: (20000, 784)
[2022-08-17 02:55:37,567 INFO] (snngp_vary_inducing_random:72) ELBO: 85002.27989607769
[2022-08-17 03:12:29,214 INFO] (snngp_vary_inducing_random:74) EUBO: 140039.42936449664
[2022-08-17 03:13:59,802 INFO] (snngp_vary_inducing_random:78) Loss: 0.09284826607145029
[2022-08-17 03:13:59,803 INFO] (snngp_vary_inducing_random:80) Accuracy: 98.05%
